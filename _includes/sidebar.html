{% include base_path %}

{% if page.author_profile or layout.author_profile or page.sidebar %}
  <div class="sidebar sticky">

    {%- comment -%}
      If author_profile is enabled on this page, render it…
    {%- endcomment -%}
    {% if page.author_profile or layout.author_profile %}
      {% include author-profile.html %}

      {%- comment -%}
        Display Google Scholar total citations from _data/citations.yml
      {%- endcomment -%}
      {% if site.data.citations.total_citations %}
        <div class="sidebar-item author-citations">
          <i class="fas fa-chart-bar"></i>
          <strong>Citations:</strong>
          {{ site.data.citations.total_citations }}
        </div>
      {% endif %}
    {% endif %}

    {%- comment -%}
      Then render any page-specific sidebar content…
    {%- endcomment -%}
    {% if page.sidebar %}
      {% for s in page.sidebar %}
        {% if s.image %}
          <img
            src="{% if s.image contains '://' %}{{ s.image }}{% else %}{{ s.image | prepend: '/images/' | prepend: base_path }}{% endif %}"
            alt="{{ s.image_alt | default: '' }}">
        {% endif %}
        {% if s.title %}<h3>{{ s.title }}</h3>{% endif %}
        {% if s.text %}{{ s.text | markdownify }}{% endif %}
      {% endfor %}
      {% if page.sidebar.nav %}
        {% include nav_list nav=page.sidebar.nav %}
      {% endif %}
    {% endif %}

  </div>
{% endif %}
